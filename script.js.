document.getElementById("generate").addEventListener("click", async () => {
  const files = document.getElementById("file-input").files;
  if (files.length === 0) {
    alert("Please upload at least one image!");
    return;
  }

  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();

  for (let i = 0; i < files.length; i++) {
    const imgURL = URL.createObjectURL(files[i]);
    const img = await loadImage(imgURL);

    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img, 0, 0);

    const imgData = canvas.toDataURL("image/jpeg", 1.0);

    if (i > 0) pdf.addPage();
    pdf.addImage(imgData, "JPEG", 0, 0, 210, 297);
  }

  pdf.save("school_pages.pdf");
});

function loadImage(url) {
  return new Promise((resolve) => {
    const img = new Image();
    img.onload = () => resolve(img);
    img.src = url;
  });
}
